<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>网络篇 on 现代技能栈</title><link>https://xiaoping378.github.io/docs/2-infra/network/</link><description>Recent content in 网络篇 on 现代技能栈</description><generator>Hugo</generator><language>zh-cn</language><lastBuildDate>Fri, 20 May 2022 10:43:31 +0800</lastBuildDate><atom:link href="https://xiaoping378.github.io/docs/2-infra/network/index.xml" rel="self" type="application/rss+xml"/><item><title>内网机穿透开发</title><link>https://xiaoping378.github.io/docs/2-infra/network/frp/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://xiaoping378.github.io/docs/2-infra/network/frp/</guid><description>&lt;div class="pageinfo pageinfo-primary"&gt;
&lt;p&gt;充分利用外网开隧道代理到本地服务，演示或者内网开发的利器，自己具备公网服务器的可以使用frp，不具备的可以使用ngrok。&lt;/p&gt;

&lt;/div&gt;

&lt;h2 id="frp介绍"&gt;FRP介绍&lt;a class="td-heading-self-link" href="#frp%e4%bb%8b%e7%bb%8d" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;frp 是国人开源的一种快速反向代理，可将 NAT 或防火墙后面的本地服务器暴露到互联网上。目前，它支持暴露 TCP 和 UDP，以及 HTTP 和 HTTPS 协议，也可以通过域名将请求转发到内部服务。&lt;/p&gt;
&lt;p&gt;&lt;img src="https://xiaoping378.github.io/images/frp-2022-03-06-20-21-49.png" alt=""&gt;&lt;/p&gt;
&lt;h2 id="安装"&gt;安装&lt;a class="td-heading-self-link" href="#%e5%ae%89%e8%a3%85" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;二进制下载&lt;a href="https://github.com/fatedier/frp/releases"&gt;地址&lt;/a&gt;, 解压后内容如下：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;➜ frp_0.39.1_linux_amd64 tree
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;.
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;├── frpc
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;├── frpc_full.ini
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;├── frpc.ini
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;├── frps
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;├── frps_full.ini
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;├── frps.ini
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;├── LICENSE
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;└── systemd
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ├── frpc.service
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ├── frpc@.service
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; ├── frps.service
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; └── frps@.service
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#666"&gt;1&lt;/span&gt; directory, &lt;span style="color:#666"&gt;11&lt;/span&gt; files
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;可将其中的 frpc 拷贝到内网服务所在的机器上，将 frps 拷贝到具有公网 IP 的机器上，放置在任意目录。&lt;/p&gt;
&lt;p&gt;后续使用思路：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;编写配置文件，先通过 ./frps -c ./frps.ini 启动服务端，&lt;/li&gt;
&lt;li&gt;再通过 ./frpc -c ./frpc.ini 启动客户端。&lt;/li&gt;
&lt;li&gt;如果需要在后台长期运行，可使用压缩包内写好的的systemd服务&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="代理ssh"&gt;代理ssh&lt;a class="td-heading-self-link" href="#%e4%bb%a3%e7%90%86ssh" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;本人日常开发使用vsocde，众所周知，其&lt;a href="https://code.visualstudio.com/docs/remote/ssh"&gt;remote SSH开发&lt;/a&gt;的特性非常惊艳，可以提供本地开发的体验，背后需要通过ssh连接到远端服务器，高配云主机价格不菲，公司电脑长期荒废中，，，，遂有了此想法，只购买一个低配的云主机用来代理到内网的公司电脑（已安装linux）上，然后利用vscode实现内网穿透开发。&lt;/p&gt;</description></item><item><title>网络TCP/IP协议栈</title><link>https://xiaoping378.github.io/docs/2-infra/network/tcpip/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://xiaoping378.github.io/docs/2-infra/network/tcpip/</guid><description>&lt;p&gt;.TODO&lt;/p&gt;</description></item><item><title>混合云网络SDN</title><link>https://xiaoping378.github.io/docs/2-infra/network/%E6%B7%B7%E5%90%88%E4%BA%91sdn%E9%80%89%E5%9E%8B/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://xiaoping378.github.io/docs/2-infra/network/%E6%B7%B7%E5%90%88%E4%BA%91sdn%E9%80%89%E5%9E%8B/</guid><description>&lt;ul&gt;
&lt;li&gt;TODO.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="为什么需要sdn"&gt;为什么需要SDN&lt;a class="td-heading-self-link" href="#%e4%b8%ba%e4%bb%80%e4%b9%88%e9%9c%80%e8%a6%81sdn" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;网络可编程&lt;/li&gt;
&lt;li&gt;VPC（Virtual Private Cloud）&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="现有sdn方案"&gt;现有SDN方案&lt;a class="td-heading-self-link" href="#%e7%8e%b0%e6%9c%89sdn%e6%96%b9%e6%a1%88" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;硬件方案（软件定义，硬件实现）&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;主流网络设备厂商有各自实现&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;软件方案（NFV）&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;VMWare NSX, Juniper OpenContrail, OpenStack DVR...&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="业务需求"&gt;业务需求&lt;a class="td-heading-self-link" href="#%e4%b8%9a%e5%8a%a1%e9%9c%80%e6%b1%82" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;用户网络隔离 - 多租户&lt;/li&gt;
&lt;li&gt;保证中等流量规模的高性能低延迟&lt;/li&gt;
&lt;li&gt;适应复杂异构的基础架构（混合云-- kubernetes，虚机，裸机）&lt;/li&gt;
&lt;li&gt;端点迁移，IP不变&lt;/li&gt;
&lt;li&gt;负载均衡（L2/L3）&lt;/li&gt;
&lt;li&gt;端到端流量精细ACL&lt;/li&gt;
&lt;li&gt;可API控制&lt;/li&gt;
&lt;li&gt;运维监控（包，字节流）&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="方案选型"&gt;方案选型&lt;a class="td-heading-self-link" href="#%e6%96%b9%e6%a1%88%e9%80%89%e5%9e%8b" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;成本&lt;/li&gt;
&lt;li&gt;设备依赖&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="开源方案"&gt;开源方案&lt;a class="td-heading-self-link" href="#%e5%bc%80%e6%ba%90%e6%96%b9%e6%a1%88" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;各开源SDN方案对比：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;flannel vxlan:
不具备网络隔离功能。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;OpenShift SDN:&lt;/p&gt;
&lt;p&gt;基于vxlan利用ovs-multienant可实现基于项目的网络隔离，和flannel vxlan相比，其使用的ovs-subnet插件，数据流场景大体一致，容器向外网发包也使用的NAT。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Calico:&lt;/p&gt;
&lt;p&gt;支持混合云，安全加密，
纯3层的路由实现保证了性能和低延迟
支持了网络隔离和ACL
但存在目前只支持TCP、UDP、ICMP、ICMPv6协议，四层协议不支持。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;OpenStack Neutron&lt;/p&gt;
&lt;p&gt;支持网络隔离
性能和低延迟 -- 需要优化
支持多租户
基于ML2支持混合云方案 -- kubernetes的支持需要第三方的kubestack项目
虚机迁移，IP可不变，容器迁移，IP不变 -- 需要开发
支持负载均衡LBaaS
支持精细级的ACL
API ?
可运维监控基本数据&lt;/p&gt;</description></item></channel></rss>