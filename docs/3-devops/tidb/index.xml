<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>TiDB分布式数据库 on 现代技能栈</title><link>https://xiaoping378.github.io/docs/3-devops/tidb/</link><description>Recent content in TiDB分布式数据库 on 现代技能栈</description><generator>Hugo</generator><language>zh-cn</language><lastBuildDate>Thu, 03 Feb 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://xiaoping378.github.io/docs/3-devops/tidb/index.xml" rel="self" type="application/rss+xml"/><item><title>TiDB初体验</title><link>https://xiaoping378.github.io/docs/3-devops/tidb/tidb-%E5%88%9D%E4%BD%93%E9%AA%8C/</link><pubDate>Thu, 03 Feb 2022 00:00:00 +0000</pubDate><guid>https://xiaoping378.github.io/docs/3-devops/tidb/tidb-%E5%88%9D%E4%BD%93%E9%AA%8C/</guid><description>&lt;h2 id="安装"&gt;安装&lt;a class="td-heading-self-link" href="#%e5%ae%89%e8%a3%85" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;blockquote&gt;
&lt;p&gt;安装环境要求：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Mac或者单机Linux环境&lt;/li&gt;
&lt;li&gt;可以连接外网&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;ol&gt;
&lt;li&gt;执行命令安装&lt;code&gt;TiUP&lt;/code&gt;工具，官方运维管理工具。&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;curl --proto &lt;span style="color:#b44"&gt;&amp;#39;=https&amp;#39;&lt;/span&gt; --tlsv1.2 -sSf https://tiup-mirrors.pingcap.com/install.sh | sh
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;命令会有关键信息输出:添加了证书、修改了PATH变量等，需要声明下环境变量，以使&lt;code&gt;tiup&lt;/code&gt;命令能被找到。&lt;/p&gt;
&lt;ol start="2"&gt;
&lt;li&gt;声明系统环境变量&lt;/li&gt;
&lt;/ol&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#080;font-style:italic"&gt;# 因个人环境，此处会有差异&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#a2f"&gt;source&lt;/span&gt; ~/.zshrc
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;可以&lt;code&gt;echo $PATH&lt;/code&gt;下，看到&lt;code&gt;/root/.tiup/bin&lt;/code&gt;被加到了最前面。&lt;/p&gt;
&lt;ol start="3"&gt;
&lt;li&gt;启动单实例集群&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;直接执行&lt;code&gt;tiup playground&lt;/code&gt;命令默认会运行最新版本的TiDB集群，其中TiDB Server、TiKV、PD 和 TiFlash 实例各 1 个：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;tiup playground
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;具体如下图所示，需要另开一个终端，使用mysql发起连接：
&lt;img src="https://xiaoping378.github.io/images/github-dev-2022-02-04-16-16-18.png" alt=""&gt;&lt;/p&gt;
&lt;p&gt;目前tidb playground默认启动监听在127的地址，可以通过--host参数更改，但还不能更改端口（经查代码是写死了端口）。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;其他可修改参数，可通过&lt;code&gt;tiup playground -h&lt;/code&gt;查看。&lt;/li&gt;
&lt;li&gt;dashboard的默认root用户没有密码，如果是公网暴露了，建议如下添加密码(我这里设置了root密码为&lt;code&gt;tidb&lt;/code&gt;):&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-bash" data-lang="bash"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mysql -h127.0.0.1 -P4000 -uroot
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;alter user &lt;span style="color:#b44"&gt;&amp;#39;root&amp;#39;&lt;/span&gt; identified by &lt;span style="color:#b44"&gt;&amp;#39;tidb&amp;#39;&lt;/span&gt;;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;ul&gt;
&lt;li&gt;grafana的登录密码，默认为admin/admin&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tiup update --self&lt;/code&gt;可升级tiup命令&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;mysql客户端可通过&lt;code&gt;yum install -y mysql&lt;/code&gt;或者&lt;code&gt;apt install mysql-client&lt;/code&gt;安装。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id="集群"&gt;集群&lt;a class="td-heading-self-link" href="#%e9%9b%86%e7%be%a4" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;没有多节点的环境，折腾了一下，要单机玩这个模式的话，需要hack的东西太多，，，目前还不建议这么搞，等有时间看能不能提个PR.&lt;/p&gt;
&lt;h2 id="tidb-server"&gt;TIDB Server&lt;a class="td-heading-self-link" href="#tidb-server" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;处理client的SQL请求.&lt;/p&gt;
&lt;h2 id="pd"&gt;PD&lt;a class="td-heading-self-link" href="#pd" aria-label="Heading self-link"&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;提供全局时钟和Region调度和管理（扩缩容）。&lt;/p&gt;</description></item></channel></rss>